(()=>{"use strict";var n={pluginUrl:besnr.plugin_url,pluginDomain:besnr.plugin_domain,ajaxUrl:besnr.ajax_url,ajaxNonce:besnr.ajax_nonce},c={ajaxRequest:function(e,t,a,r){jQuery.ajax({method:"post",url:n.ajaxUrl,data:jQuery.extend({action:e,_wpnonce:n.ajaxNonce},a),beforeSend:function(){return c.beforeSendCallback(t)},success:function(e){return r(JSON.parse(e)[0])},complete:function(){return c.completeCallback(t)},error:function(){return c.errorCallback(t)}})},beforeSendCallback:function(e){e.find(".besnr-loading-bar").show()},completeCallback:function(e){e.find(".besnr-loading-bar").hide()},errorCallback:function(e){var e=e.find(".besnr-output").empty(),t='<storng>Internal Server Error!</strong><br />Contact your hosting provider and access your logs to learn more about what is causing the error; then the plugin author with the detials @ <a href="mailto:contact@'.concat(n.pluginDomain,'">contact@').concat(n.pluginDomain,"</a>.");e.addClass("besnr-output-active besnr-output-active-error"),e.html(t)},outputCallback:function(e,t,a){e=e.find(".besnr-output").empty();e.removeClass("besnr-output-active-success besnr-output-active-error").addClass("besnr-output-active-"+(1===t?"success":"error")),e.addClass("besnr-output-active").show().html(a)}},R={};function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var r,n,c,l,i=[],s=!0,o=!1;try{if(c=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;s=!1}else for(;!(s=(r=c.call(a)).done)&&(i.push(r.value),i.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{if(!s&&null!=a.return&&(l=a.return(),Object(l)!==l))return}finally{if(o)throw n}}return i}}(e,t)||function(e,t){var a;if(e)return"string"==typeof e?r(e,t):"Map"===(a="Object"===(a=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:a)||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}R.highlightSearchText=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"classic",a=(e.preventDefault(),jQuery(e.target).closest(".besnr-admin")),e={current_post_id:a.find('input[name="besnr-current-post-id"]').val(),search_input:a.find('[name="besnr-search-input"]').val(),search_method:a.find('select[name="besnr-search-method"]').val(),is_dry_run:a.find('input[name="besnr-dry-run"]:checked').length,is_highlighted:a.find('input[name="besnr-highlight-search"]:checked').length,is_case_sensitive:a.find('input[name="besnr-case-sensitive"]:checked').length};c.ajaxRequest("besnr_highlight_search",a,e,function(e){2===e.status&&(R.updateEditorContents(e,a,t),a.find('button[name="besnr-preview-changes"]').hide()),c.outputCallback(a,1,e.message)})},R.defaultSearchReplace=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"classic",a=(e.preventDefault(),jQuery(e.target).closest(".besnr-admin")),r=a.find('select[name="besnr-search-method"]').val(),e={current_post_id:a.find('input[name="besnr-current-post-id"]').val(),search_input:a.find('[name="besnr-search-input"]').val(),replace_with_input:a.find('[name="besnr-replace-with-input"]').val(),search_method:r,is_highlighted:a.find('input[name="besnr-highlight-search"]:checked').length,is_case_sensitive:a.find('input[name="besnr-case-sensitive"]:checked').length};c.ajaxRequest("besnr_default_search_replace",a,e,function(e){R.updateEditorContents(e,a,t),a.find('select[name="besnr-search-method"]').val(r),a.find('[name="besnr-search-input"]').val(""),a.find('[name="besnr-replace-with-input"]').val("")})},R.removeHighlightTags=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"classic",a=(e.preventDefault(),jQuery(e.target).closest(".besnr-admin")),e={current_post_id:a.find('input[name="besnr-current-post-id"]').val()};c.ajaxRequest("besnr_remove_highlight_tags",a,e,function(e){R.updateEditorContents(e,a,t),a.find('[name="besnr-search-input"]').val(""),a.find('[name="besnr-replace-with-input"]').val("")})},R.updateEditorContents=function(e,t,a){var r={current_post_id:t.find('input[name="besnr-current-post-id"]').val()};0!==e.status&&1!==e.status||c.outputCallback(t,e.status,e.message),c.ajaxRequest("besnr_update_editor_contents",t,r,function(e){var t;e&&!1===e.success||2!==e.status||(e=(new DOMParser).parseFromString(e.message,"text/html").documentElement.textContent,"classic"===a?(t=jQuery("<style/>").html("besnr-highlight { background-color: #87ceeb; padding: 3px; }"),jQuery("#content_ifr").contents().find("head").append(t),jQuery("#content_ifr").contents().find("body").empty().html(e)):(0,window.wp.data.dispatch)("core/editor").editPost({content:e}))})};var e={};e.init=function(){var d=wp.i18n.__,e=wp.element,m=e.useState,b=e.useEffect,e=wp.components,g=e.Button,f=e.Dashicon,v=e.SelectControl,e=wp.plugins.registerPlugin,y=wp.editor.PluginSidebar,E=wp.data.useSelect;e("block-editor-search-replace-plugin",{render:function(){function t(e){var t,a=jQuery(e.target);t||(jQuery('div[id^="__wp-uploader-id"]').remove(),(t=wp.media.frames.meta_image_frame=wp.media({title:"Block Editor S/R (Images)",button:{text:"Select Image"}})).on("select",function(){var e=t.state().get("selection").first().toJSON();a.val(e.url)})),t.open()}function e(e){R.highlightSearchText(e,"block")}var a=E(function(e){return{postType:e("core/editor").getCurrentPostType(),postId:e("core/editor").getCurrentPostId()}}),r=a.postType,a=a.postId,n=k(m(!0),2),c=n[0],l=n[1],n=k(m(!1),2),i=n[0],s=n[1],n=k(m("text"),2),o=n[0],n=n[1],u=k(m({}),2),h=u[0],p=u[1],u=(b(function(){switch(o){case"text":p({searchPlaceholder:d("Enter your search phrase...","block-editor-search-replace"),replacePlaceholder:d("Enter your replace with phrase...","block-editor-search-replace"),inputType:"text",highlight:!0,caseSensitive:!0,dryRun:!0});break;case"url":p({searchPlaceholder:d("Enter URL to search...","block-editor-search-replace"),replacePlaceholder:d("Enter your replacement URL...","block-editor-search-replace"),inputType:"textarea",highlight:!0,caseSensitive:!1,dryRun:!0});break;case"image":p({searchPlaceholder:d("Enter image URL to search...","block-editor-search-replace"),replacePlaceholder:d("Enter your replacement image URL...","block-editor-search-replace"),inputType:"textarea",highlight:!0,caseSensitive:!1,dryRun:!0});break;case"multiple":p({searchPlaceholder:d("Enter multiple terms separate w/ comma...","block-editor-search-replace"),replacePlaceholder:d("Enter your replacement terms...","block-editor-search-replace"),inputType:"textarea",highlight:!0,caseSensitive:!0,dryRun:!0})}},[o]),[{label:d("Text-only","block-editor-search-replace"),value:"text"},{label:d("URLs","block-editor-search-replace"),value:"url"},{label:d("Images","block-editor-search-replace"),value:"image"},{label:d("Multiple Terms","block-editor-search-replace"),value:"multiple"}]);return React.createElement(y,{name:"block-editor-search-replace",title:d("Block Editor S/R","block-editor-search-replace"),icon:"search"},React.createElement("div",{className:"besnr-admin"},React.createElement("div",{className:"besnr-form-ui"},React.createElement("form",{id:"besnr-form",name:"besnr-form",type:"post"},React.createElement("div",{className:"besnr-loading-bar"}),React.createElement("div",{id:"besnr-output",className:"besnr-output"}),React.createElement("input",{type:"hidden",id:"besnr-current-post-type",name:"besnr-current-post-type",value:r}),React.createElement("input",{type:"hidden",id:"besnr-current-post-id",name:"besnr-current-post-id",value:a}),React.createElement("div",{className:"search-replace-group"},React.createElement("p",null,d("Easily find and replace anything in the Block Editor with our search and replace plugin.","block-editor-search-replace")),React.createElement("p",{style:{display:h.highlight?"inline-block":"none"}},React.createElement("label",{htmlFor:"besnr-highlight-search"},React.createElement("input",{type:"checkbox",id:"besnr-highlight-search",name:"besnr-highlight-search",checked:c,onChange:function(){return l(!c)},disabled:!h.highlight}),React.createElement("span",null,d("Highlight search results","block-editor-search-replace")))),React.createElement("p",{style:{display:h.caseSensitive?"inline-block":"none"}},React.createElement("label",{htmlFor:"besnr-case-sensitive"},React.createElement("input",{type:"checkbox",id:"besnr-case-sensitive",name:"besnr-case-sensitive",checked:i,onChange:function(){return s(!i)},disabled:!h.caseSensitive}),React.createElement("span",null,d("Case sensitive search & replace","block-editor-search-replace")))),React.createElement("p",null,React.createElement(v,{id:"besnr-search-method",name:"besnr-search-method",className:"besnr-search-method",value:o,options:u,onChange:n,__nextHasNoMarginBottom:!0})),React.createElement("p",null,"text"===o?React.createElement("input",{type:h.inputType,id:"besnr-search-input",name:"besnr-search-input",className:"besnr-search-input",placeholder:h.searchPlaceholder,onBlur:e}):React.createElement("textarea",{id:"besnr-search-input",name:"besnr-search-input",className:"besnr-search-input",placeholder:h.searchPlaceholder,onBlur:e,onClick:function(e){"image"===o&&t(e)}})),React.createElement("p",null,"text"===o?React.createElement("input",{type:h.inputType,id:"besnr-replace-with-input",name:"besnr-replace-with-input",className:"besnr-replace-with-input",placeholder:h.replacePlaceholder}):React.createElement("textarea",{id:"besnr-replace-with-input",name:"besnr-replace-with-input",className:"besnr-replace-with-input",placeholder:h.replacePlaceholder,onClick:function(e){"image"===o&&t(e)}})),React.createElement("p",{id:"besnr-button-group",className:"button-group"},React.createElement(g,{id:"besnr-default-search-replace",name:"besnr-default-search-replace",className:"components-button is-primary is-compact besnr-default-search-replace",onClick:function(e){R.defaultSearchReplace(e,"block")}},React.createElement(f,{icon:"randomize"}),d("Replace","block-editor-search-replace")),React.createElement(g,{id:"besnr-remove-highlight-tags",name:"besnr-remove-highlight-tags",className:"button is-compact",onClick:function(e){R.removeHighlightTags(e,"block")}},d("Remove tags","block-editor-search-replace"))),React.createElement("p",null,React.createElement("span",null,React.createElement("strong",null,"Hint:")," Use ",React.createElement("code",null,"Ctrl + Z")," then ",React.createElement("code",null,"Ctrl + S")," to go back to the original content.")),React.createElement("p",null,React.createElement("hr",null),React.createElement("span",null,d("• Search action will fire automatically as you leave the input field.","block-editor-search-replace"))))))))}})},jQuery,e.init()})();